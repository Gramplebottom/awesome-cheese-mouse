<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nacho Guzzler Pro | Awesome Cheese Mouse</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #ffcc00;
            --secondary: #ff9900;
            --accent: #ff00ff;
            --glass: rgba(255, 255, 255, 0.1);
        }

        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background: radial-gradient(circle at center, #2e1a47 0%, #0a0a1a 100%);
            font-family: 'Poppins', sans-serif; color: white;
        }

        #game-container {
            position: relative; width: 100vw; height: 100vh;
            display: flex; align-items: center; justify-content: center;
        }

        canvas { display: block; z-index: 1; }

        /* UI Layer */
        .ui-panel {
            position: absolute; z-index: 10; pointer-events: none;
            width: 100%; height: 100%; top: 0; left: 0;
        }

        .hud {
            padding: 20px; display: flex; justify-content: space-between;
            background: linear-gradient(to bottom, rgba(0,0,0,0.5), transparent);
        }

        .stat-box {
            background: var(--glass); backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 10px 25px; border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .score-val { font-family: 'Fredoka One'; font-size: 2.5rem; color: var(--primary); text-shadow: 0 0 15px rgba(255,204,0,0.5); }

        /* Overlays */
        .overlay {
            position: absolute; inset: 0; background: rgba(10, 10, 26, 0.85);
            backdrop-filter: blur(8px); display: flex; flex-direction: column;
            align-items: center; justify-content: center; z-index: 100;
            transition: opacity 0.4s ease;
        }

        .glass-card {
            background: var(--glass); border: 1px solid rgba(255,255,255,0.1);
            padding: 50px; border-radius: 40px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); max-width: 80%;
        }

        h1 { font-family: 'Fredoka One'; font-size: 4.5rem; margin: 0; color: var(--primary); letter-spacing: 2px; }
        
        .btn {
            background: linear-gradient(45deg, var(--secondary), var(--primary));
            border: none; padding: 18px 45px; border-radius: 50px;
            color: #2e1a47; font-weight: 800; font-size: 1.4rem;
            cursor: pointer; pointer-events: auto; transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 30px; text-transform: uppercase;
        }

        .btn:hover { transform: scale(1.05); box-shadow: 0 0 30px var(--secondary); }

        .frenzy-bar {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            width: 300px; height: 15px; background: rgba(255,255,255,0.1);
            border-radius: 10px; overflow: hidden; border: 1px solid rgba(255,255,255,0.2);
        }
        #frenzy-fill { width: 0%; height: 100%; background: var(--accent); transition: width 0.1s; }

        .hidden { opacity: 0; pointer-events: none; }
    </style>
</head>
<body>

<div id="game-container">
    <div class="ui-panel">
        <div class="hud">
            <div class="stat-box">
                <div style="font-size: 0.8rem; opacity: 0.8;">TOTAL CHEESE</div>
                <div id="score" class="score-val">0</div>
            </div>
            <div class="stat-box">
                <div style="font-size: 0.8rem; opacity: 0.8;">COMBO</div>
                <div id="combo" class="score-val" style="color: var(--accent);">x1</div>
            </div>
        </div>
        <div class="frenzy-bar"><div id="frenzy-fill"></div></div>
    </div>

    <div id="start-screen" class="overlay">
        <div class="glass-card">
            <h1>NACHO<br>GUZZLER</h1>
            <p style="opacity: 0.7; margin-top: 10px;">The Ultimate Professional Engorgement Experience</p>
            <button class="btn" onclick="startGame()">Begin Feast</button>
        </div>
    </div>

    <div id="game-over" class="overlay hidden">
        <div class="glass-card">
            <h1 style="color: #ff4444;">BURP!</h1>
            <p id="final-stats" style="font-size: 1.5rem;"></p>
            <button class="btn" onclick="startGame()">Try Again</button>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let w, h, score = 0, combo = 1, comboTimer = 0, lives = 3;
let gameActive = false, mouseX = 0, frenzy = 0;
let objects = [], particles = [], popups = [];

// --- Professional Character Model Config ---
const mouse = {
    x: 0, y: 0,
    bellyWidth: 140,
    bellyHeight: 120,
    targetBelly: 140,
    mouthOpen: 0,
    eyeTarget: {x: 0, y: 0},
    wobble: 0
};

const resize = () => {
    w = canvas.width = window.innerWidth;
    h = canvas.height = window.innerHeight;
    mouse.x = w / 2;
    mouse.y = h - 50;
};
window.addEventListener('resize', resize);
resize();

// Input
const handleMove = (e) => {
    const x = e.touches ? e.touches[0].clientX : e.clientX;
    mouseX = x;
};
canvas.addEventListener('mousemove', handleMove);
canvas.addEventListener('touchmove', (e) => { handleMove(e); e.preventDefault(); }, {passive: false});

function spawnNacho() {
    if(!gameActive) return;
    objects.push({
        x: Math.random() * (w - 60) + 30,
        y: -100,
        vy: 4 + Math.random() * 4,
        rot: Math.random() * Math.PI * 2,
        rs: (Math.random() - 0.5) * 0.1,
        size: 25 + Math.random() * 15
    });
    let delay = frenzy > 0 ? 100 : Math.max(200, 800 - (score / 10));
    setTimeout(spawnNacho, delay);
}

function startGame() {
    score = 0; combo = 1; lives = 3; frenzy = 0;
    objects = []; particles = []; popups = [];
    gameActive = true;
    document.getElementById('start-screen').classList.add('hidden');
    document.getElementById('game-over').classList.add('hidden');
    spawnNacho();
    requestAnimationFrame(loop);
}

function drawMouse() {
    // Physics & Belly Jiggl
    mouse.x += (mouseX - mouse.x) * 0.15;
    mouse.bellyWidth += (mouse.targetBelly - mouse.bellyWidth) * 0.1;
    mouse.wobble = Math.sin(Date.now() * 0.005) * 5;
    
    const bx = mouse.x;
    const by = h - 60;

    ctx.save();
    
    // 1. Shadow
    ctx.shadowBlur = 40; ctx.shadowColor = 'rgba(0,0,0,0.5)';
    
    // 2. Belly (Base Gradient)
    const bellyGrad = ctx.createRadialGradient(bx, by - 50, 20, bx, by - 50, mouse.bellyWidth);
    bellyGrad.addColorStop(0, '#999');
    bellyGrad.addColorStop(1, '#555');
    
    ctx.fillStyle = bellyGrad;
    ctx.beginPath();
    ctx.ellipse(bx, by - (mouse.bellyHeight/2) + mouse.wobble, mouse.bellyWidth, mouse.bellyHeight, 0, 0, Math.PI*2);
    ctx.fill();

    // 3. Belly Patch (Lighter)
    ctx.fillStyle = 'rgba(255,255,255,0.1)';
    ctx.beginPath();
    ctx.ellipse(bx, by - (mouse.bellyHeight/2) + 10 + mouse.wobble, mouse.bellyWidth * 0.7, mouse.bellyHeight * 0.8, 0, 0, Math.PI*2);
    ctx.fill();

    // 4. Arms
    ctx.strokeStyle = '#666'; ctx.lineWidth = 12; ctx.lineCap = 'round';
    ctx.beginPath();
    ctx.moveTo(bx - mouse.bellyWidth * 0.8, by - 100);
    ctx.lineTo(bx - mouse.bellyWidth - 20, by - 150 + Math.sin(Date.now()*0.01)*20);
    ctx.moveTo(bx + mouse.bellyWidth * 0.8, by - 100);
    ctx.lineTo(bx + mouse.bellyWidth + 20, by - 150 + Math.cos(Date.now()*0.01)*20);
    ctx.stroke();

    // 5. Head
    const hx = bx;
    const hy = by - mouse.bellyHeight - 30 + mouse.wobble;
    
    // Ears
    ctx.fillStyle = '#ffb3ba';
    ctx.beginPath(); ctx.arc(hx - 50, hy - 60, 35, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(hx + 50, hy - 60, 35, 0, Math.PI*2); ctx.fill();

    // Face Base
    const headGrad = ctx.createRadialGradient(hx, hy - 20, 10, hx, hy, 70);
    headGrad.addColorStop(0, '#888'); headGrad.addColorStop(1, '#444');
    ctx.fillStyle = headGrad;
    ctx.beginPath(); ctx.arc(hx, hy, 70, 0, Math.PI*2); ctx.fill();

    // Eyes tracking
    const drawEye = (ex, ey) => {
        ctx.fillStyle = 'white';
        ctx.beginPath(); ctx.arc(ex, ey, 22, 0, Math.PI*2); ctx.fill();
        // Pupil
        const dx = (mouseX - (hx + ex)) * 0.05;
        const dy = -2;
        ctx.fillStyle = '#111';
        ctx.beginPath(); ctx.arc(ex + dx, ey + dy, 10, 0, Math.PI*2); ctx.fill();
        // Highlight
        ctx.fillStyle = 'white';
        ctx.beginPath(); ctx.arc(ex + dx - 4, ey + dy - 4, 4, 0, Math.PI*2); ctx.fill();
    };
    drawEye(hx - 30, hy - 30);
    drawEye(hx + 30, hy - 30);

    // Mouth
    const mOpen = 15 + (mouse.mouthOpen * 60);
    ctx.fillStyle = '#211';
    ctx.beginPath(); ctx.ellipse(hx, hy + 30, 45, mOpen, 0, 0, Math.PI*2); ctx.fill();
    
    // Tongue
    ctx.fillStyle = '#ff6b6b';
    ctx.beginPath(); ctx.ellipse(hx, hy + 30 + mOpen - 10, 25, 10, 0, 0, Math.PI*2); ctx.fill();

    // Teeth
    ctx.fillStyle = 'white';
    ctx.fillRect(hx - 15, hy + 30 - mOpen, 12, 15);
    ctx.fillRect(hx + 3, hy + 30 - mOpen, 12, 15);

    ctx.restore();
    if(mouse.mouthOpen > 0) mouse.mouthOpen *= 0.85;
}

function loop() {
    if(!gameActive) return;
    ctx.clearRect(0,0,w,h);

    // Background Particles
    if(Math.random() > 0.9) particles.push({x: Math.random()*w, y:h+10, vy:-Math.random()*2, s:Math.random()*3, a:1});

    // Update Objects
    for(let i=objects.length-1; i>=0; i--) {
        let n = objects[i];
        n.y += n.vy; n.rot += n.rs;

        // Draw Nacho
        ctx.save();
        ctx.translate(n.x, n.y);
        ctx.rotate(n.rot);
        ctx.shadowBlur = 15; ctx.shadowColor = 'rgba(255,153,0,0.5)';
        const g = ctx.createLinearGradient(-n.size, -n.size, n.size, n.size);
        g.addColorStop(0, '#ffcc00'); g.addColorStop(1, '#ff9900');
        ctx.fillStyle = g;
        ctx.beginPath(); ctx.moveTo(0, -n.size); ctx.lineTo(n.size, n.size); ctx.lineTo(-n.size, n.size); ctx.fill();
        ctx.restore();

        // Check distance for mouth open animation
        const dist = Math.hypot(n.x - mouse.x, n.y - (h - 150));
        if(dist < 200) mouse.mouthOpen = Math.max(mouse.mouthOpen, (200-dist)/200);

        // Collision
        if(dist < 80) {
            score += 10 * combo;
            frenzy = Math.min(100, frenzy + 5);
            comboTimer = 100;
            mouse.targetBelly += 2;
            objects.splice(i, 1);
            popups.push({x: n.x, y: n.y, t: `+${10*combo}`, a:1});
            if(frenzy >= 100) startFrenzy();
        } else if(n.y > h) {
            objects.splice(i, 1);
            if(frenzy <= 0) {
                lives--;
                if(lives <= 0) endGame();
            }
        }
    }

    // UI Updates
    if(comboTimer > 0) {
        comboTimer--;
        if(comboTimer % 20 === 0 && comboTimer > 0) combo++;
    } else {
        combo = 1;
    }

    document.getElementById('score').innerText = score;
    document.getElementById('combo').innerText = `x${combo}`;
    document.getElementById('frenzy-fill').style.width = frenzy + '%';

    drawMouse();

    // Render Popups & Particles
    ctx.font = 'bold 30px Fredoka One';
    popups.forEach((p, i) => {
        p.y -= 2; p.a -= 0.02;
        ctx.fillStyle = `rgba(255, 204, 0, ${p.a})`;
        ctx.fillText(p.t, p.x, p.y);
        if(p.a <= 0) popups.splice(i, 1);
    });

    requestAnimationFrame(loop);
}

function startFrenzy() {
    // Logic for rainbow/fast mode
    const fInterval = setInterval(() => {
        frenzy -= 1;
        if(frenzy <= 0) clearInterval(fInterval);
    }, 50);
}

function endGame() {
    gameActive = false;
    document.getElementById('game-over').classList.remove('hidden');
    document.getElementById('final-stats').innerText = `You Guzzled ${score} Liters of Cheese!`;
}

// Global visual flair
setInterval(() => {
    if(gameActive && frenzy > 80) {
        canvas.style.filter = `hue-rotate(${Date.now()%360}deg)`;
    } else {
        canvas.style.filter = 'none';
    }
}, 50);

</script>
</body>
</html>
