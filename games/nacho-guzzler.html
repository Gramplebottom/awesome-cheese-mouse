<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NACHO GUZZLER: ABSURD EDITION</title>
    <style>
        body {
            margin: 0; background: #200; overflow: hidden;
            font-family: 'Comic Sans MS', 'Arial Black', sans-serif;
            touch-action: none; color: #ffcc00;
        }
        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 10;
        }
        .stat { position: absolute; font-size: 2rem; font-weight: 900; text-shadow: 4px 4px #000; }
        #score { top: 20px; left: 20px; color: #ffcc00; }
        #streak { top: 20px; right: 20px; color: #ff00ff; transform: rotate(10deg); }
        
        .overlay {
            position: absolute; inset: 0; background: rgba(0,0,0,0.9);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 20; text-align: center; cursor: pointer;
        }
        h1 { font-size: 5rem; color: #ff9900; margin: 0; text-shadow: 0 0 20px #fff; animation: wobble 0.2s infinite; }
        @keyframes wobble { 0% { transform: rotate(-2deg); } 50% { transform: rotate(2deg); } 100% { transform: rotate(-2deg); } }
        .hidden { display: none; }
    </style>
</head>
<body>

<div id="ui-layer">
    <div id="score" class="stat">CHEESE: 0L</div>
    <div id="streak" class="stat">STREAK: 0</div>
</div>

<div id="start-screen" class="overlay" onclick="startGame()">
    <h1>NACHO GUZZLER</h1>
    <p style="font-size: 2rem;">CLICK TO ENGORGE</p>
    <p>AWESOME CHEESE MOUSE BRANDâ„¢</p>
</div>

<div id="game-over" class="overlay hidden" onclick="startGame()">
    <h1 id="burp-text">MAMMOTHER BURP!</h1>
    <p id="final-score" style="font-size: 2rem;"></p>
    <p>TAP TO RELAPSE INTO CHEESE ADDICTION</p>
</div>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let w, h, score = 0, streak = 0, lives = 5, gameActive = false;
let mouseX = 0, bellySize = 100, shake = 0, frenzy = 0;
let particles = [], splats = [], foods = [], popups = [];

// Audio 
let audioCtx;
const playTone = (f, t, d, v=0.1) => {
    if(!audioCtx) return;
    const o = audioCtx.createOscillator(), g = audioCtx.createGain();
    o.type = t; o.frequency.setValueAtTime(f, audioCtx.currentTime);
    g.gain.setValueAtTime(v, audioCtx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + d);
    o.connect(g); g.connect(audioCtx.destination);
    o.start(); o.stop(audioCtx.currentTime + d);
};

const resize = () => { w = canvas.width = window.innerWidth; h = canvas.height = window.innerHeight; mouseX = w/2; };
window.addEventListener('resize', resize);
resize();

// Input
const move = (e) => { mouseX = (e.touches ? e.touches[0].clientX : e.clientX); };
window.addEventListener('mousemove', move);
window.addEventListener('touchmove', move);

function spawnFood() {
    if(!gameActive) return;
    const count = frenzy > 0 ? 5 : 1;
    for(let i=0; i<count; i++) {
        foods.push({
            x: Math.random() * w, y: -50,
            vy: (Math.random() * 5 + 5) * (frenzy > 0 ? 2 : 1),
            size: 20 + Math.random() * 30,
            rot: Math.random() * Math.PI * 2,
            rs: Math.random() * 0.2 - 0.1
        });
    }
    setTimeout(spawnFood, frenzy > 0 ? 50 : 600 - Math.min(score/2, 400));
}

function createSplat(x, y, color) {
    for(let i=0; i<15; i++) {
        particles.push({
            x, y, 
            vx: (Math.random() - 0.5) * 20, 
            vy: (Math.random() - 0.5) * 20, 
            life: 1, 
            s: Math.random() * 10,
            c: color
        });
    }
}

function spawnPopup(text) {
    popups.push({ x: mouseX + (Math.random()-0.5)*200, y: h-300, text, life: 1, s: 20 + Math.random()*40 });
}

function startGame() {
    if(!audioCtx) audioCtx = new AudioContext();
    score = 0; streak = 0; lives = 5; bellySize = 120; frenzy = 0;
    foods = []; particles = []; popups = []; gameActive = true;
    document.getElementById('start-screen').classList.add('hidden');
    document.getElementById('game-over').classList.add('hidden');
    spawnFood();
    requestAnimationFrame(loop);
}

function loop() {
    if(!gameActive) return;
    
    // Background Pulse
    ctx.fillStyle = frenzy > 0 ? `hsl(${Date.now()%360}, 50%, 10%)` : '#100';
    ctx.fillRect(0,0,w,h);

    if (shake > 0) {
        ctx.save();
        ctx.translate((Math.random()-0.5)*shake, (Math.random()-0.5)*shake);
        shake *= 0.9;
    }

    // Update Foods
    for(let i=foods.length-1; i>=0; i--) {
        let f = foods[i];
        f.y += f.vy; f.rot += f.rs;
        
        // DRAW NACHO
        ctx.save();
        ctx.translate(f.x, f.y);
        ctx.rotate(f.rot);
        ctx.fillStyle = '#ffcc00';
        ctx.beginPath();
        ctx.moveTo(0, -f.size); ctx.lineTo(f.size, f.size); ctx.lineTo(-f.size, f.size);
        ctx.fill();
        ctx.restore();

        // Collision
        const dx = f.x - mouseX;
        const dy = f.y - (h - 220);
        if(Math.abs(dx) < bellySize * 0.8 && Math.abs(dy) < 100) {
            score += 10; streak++;
            bellySize += 1.5;
            shake = 15;
            createSplat(f.x, f.y, '#ff9900');
            playTone(100 + Math.random()*300, 'square', 0.1);
            if(streak % 10 === 0) spawnPopup(["GUZZLE!", "CHOMP!", "SPLORCH!", "YESSS!", "CHEESE!"][Math.floor(Math.random()*5)]);
            if(streak > 30 && frenzy <= 0) { frenzy = 300; spawnPopup("CHEESE FRENZY!!!"); }
            foods.splice(i, 1);
        } else if (f.y > h) {
            if(frenzy <= 0) lives--;
            streak = 0;
            foods.splice(i, 1);
            if(lives <= 0) { gameActive = false; document.getElementById('game-over').classList.remove('hidden'); document.getElementById('final-score').innerText = "TOTAL ENGORGEMENT: " + score + "L"; }
        }
    }

    // DRAW MOUSE (The Masterpiece)
    const time = Date.now() * 0.01;
    const wobble = Math.sin(time) * 10;
    const bounce = Math.abs(Math.sin(time*0.5)) * 20;

    ctx.save();
    ctx.translate(mouseX, h - 50);

    // Flailing Arms
    ctx.strokeStyle = '#888'; ctx.lineWidth = 10;
    ctx.beginPath();
    ctx.moveTo(-bellySize*0.6, -50); ctx.lineTo(-bellySize*0.9 + Math.sin(time*2)*30, -100 + Math.cos(time*2)*30);
    ctx.moveTo(bellySize*0.6, -50); ctx.lineTo(bellySize*0.9 + Math.cos(time*2)*30, -100 + Math.sin(time*2)*30);
    ctx.stroke();

    // JIGGLY BELLY
    ctx.fillStyle = '#777';
    ctx.beginPath();
    ctx.ellipse(0, -bellySize/2 + bounce, bellySize * 1.2, bellySize + wobble, 0, 0, Math.PI*2);
    ctx.fill();
    ctx.strokeStyle = '#555'; ctx.lineWidth = 5; ctx.stroke();
    
    // Sweat Drops
    if(score > 100) {
        ctx.fillStyle = '#0cf';
        for(let i=0; i<3; i++) {
            ctx.beginPath(); ctx.arc(-bellySize + Math.sin(time+i)*20, -bellySize + Math.cos(time*0.5+i)*50, 5, 0, 7); ctx.fill();
        }
    }

    // THE FACE
    ctx.translate(0, -bellySize - bounce);
    
    // Ears
    ctx.fillStyle = '#ff99bb';
    ctx.beginPath(); ctx.arc(-60, -80, 40, 0, 7); ctx.arc(60, -80, 40, 0, 7); ctx.fill();

    // Eyes (Bulging)
    const eyeSize = 30 + (frenzy > 0 ? Math.sin(time*5)*10 : 0);
    ctx.fillStyle = 'white';
    ctx.beginPath(); ctx.arc(-40, -100, eyeSize, 0, 7); ctx.arc(40, -100, eyeSize, 0, 7); ctx.fill();
    ctx.fillStyle = 'black';
    ctx.beginPath(); 
    ctx.arc(-40 + Math.sin(time)*10, -100 + Math.cos(time)*10, 10, 0, 7); 
    ctx.arc(40 + Math.cos(time)*10, -100 + Math.sin(time)*10, 10, 0, 7); 
    ctx.fill();

    // THE MAW (Drooling)
    ctx.fillStyle = '#300';
    ctx.beginPath(); ctx.ellipse(0, -20, 80, 100 + Math.sin(time*5)*10, 0, 0, 7); ctx.fill();
    
    // Teeth & Tongue
    ctx.fillStyle = '#fff'; ctx.fillRect(-20, -110, 15, 20); ctx.fillRect(5, -110, 15, 20);
    ctx.fillStyle = '#f55'; ctx.beginPath(); ctx.ellipse(0, 30 + Math.sin(time*10)*10, 40, 20, 0, 0, 7); ctx.fill();

    // DROOL
    ctx.fillStyle = 'rgba(255, 255, 0, 0.5)';
    ctx.fillRect(-10, 40, 5, 40 + Math.sin(time)*20);
    ctx.fillRect(20, 30, 5, 30 + Math.cos(time)*20);

    ctx.restore();

    // Particles & Popups
    particles.forEach((p, i) => {
        p.x += p.vx; p.y += p.vy; p.vy += 0.5; p.life -= 0.02;
        ctx.fillStyle = p.c; ctx.globalAlpha = p.life;
        ctx.beginPath(); ctx.arc(p.x, p.y, p.s, 0, 7); ctx.fill();
        if(p.life <= 0) particles.splice(i, 1);
    });
    ctx.globalAlpha = 1;

    popups.forEach((p, i) => {
        p.y -= 2; p.life -= 0.02;
        ctx.fillStyle = `rgba(255, 255, 255, ${p.life})`;
        ctx.font = `bold ${p.s}px Impact`;
        ctx.fillText(p.text, p.x, p.y);
        if(p.life <= 0) popups.splice(i, 1);
    });

    if(frenzy > 0) frenzy--;
    document.getElementById('score').innerText = `CHEESE: ${score}L`;
    document.getElementById('streak').innerText = streak > 5 ? `COMBO: ${streak}x` : "";
    
    if (shake > 0) ctx.restore();
    requestAnimationFrame(loop);
}

// Start immediately on load
window.onload = resize;
</script>
</body>
</html>
